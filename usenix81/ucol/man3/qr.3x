.EQ
delim $$
.EN
.TH QR 3X CIRES
.SH NAME
.PP
qr \- solve overdetermined least squares problem
.SH SYNOPSIS
.PP
\fBcall qr(m,n,a,b,x,resq)
.PP
\fBreal a(m,n),b(n),x(n),resq
.PP
\fBinteger*2 m,n
.PP
f77 flag: \fB-lCm\fR
.SH DESCRIPTION
.PP
This subroutine solves an overdetermined least squares problem
(number of unknowns $<=$ number of data)
using Householder rotations to perform the QR decomposition.
This method is numerically more stable than the conventional
one of forming the normal equations and computing the inverse
matrix.
The arguments are:
.IP \fBm\fR
the number of data values to be fit to.
.IP \fBn\fR
the number of parameters to fit (or, equivalently, the
number of fitting functions).
The program will solve only cases for which \fBn\fR $<=$ \fBm\fR.
.IP \fBa\fR
the matrix of functional values, dimensioned \fBm\fR
by \fBn\fR.
(The transpose of this matrix times this matrix is
the square matrix of the normal equations).
This matrix is overwritten and replaced by a right triangular
matrix (see \fIqrcov\fR for a use for this).
.IP \fBb\fR
the vector of data values, overwritten during computation.
.IP \fBx\fR
the vector of parameters to be fit.
.IP \fBresq\fR
the sum of squares of residuals between the least squares
fit and the data values.
.SH DIAGNOSTICS
\fBresq\fR is returned < 0 if the system is underdetermined.
.SH SEE ALSO
\fIqrcov\fR(3X), \fIur2\fR(3X)
.SH AUTHOR
R. L. Parker (UCSD)
.SH SPONSOR
D. C. Agnew (CIRES)
.SH BUGS
The program is not protected against the case \fBm\fR $>=$
\fBn\fR but rank(\fBa\fR) < \fBn\fR.
