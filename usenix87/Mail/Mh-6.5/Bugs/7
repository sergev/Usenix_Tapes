Received: from  by plus5.com (UIUC-5.31/24Nov86-03:13:38) with UUCP
	id AA18839; Wed, 11 Mar 87 05:09:09 EST
Received: by seismo.CSS.GOV (5.54/1.14) 
	id AA02437; Wed, 11 Mar 87 05:01:40 EST
Message-Id: <8703111001.AA02437@seismo.CSS.GOV>
Received: from bboards by ICS.UCI.EDU id a016227; 10 Mar 87 23:49 PST
Received: from hplabs.hp.com by ICS.UCI.EDU id a016200; 10 Mar 87 23:43 PST
Received: by hplabs.HP.COM ; Tue, 10 Mar 87 23:37:39 pst
Received: by hpsemc; Tue, 10 Mar 87 10:28:03 pst
From: Bob Desinger <hplabs.hp.com!hpsemc!bd>
To: relay.cs.net!neil%buffalo.csnet
Cc: ics.uci.edu!mh-workers, hplabs.hp.com!hpda!carolyn,
        hplabs.hp.com!hplabs!kincl
Subject: Re: n't scan and inc parse dates correctly? 
In-Reply-To: Your message of Sun, 08 Mar 87 17:06:00 -0500
Date: Tue, 10 Mar 87 10:27:53 PST

> We just installed mh 6.5 on our VAX and have run into a problem of
> scan and inc not parsing dates correctly.  I then dug into our
> archives and found that you had encountered this problem in July of
> 86.  I was wondering if you ever fixed it or how you avoided it (right
> now we are running mh 6.4 scan which I'd prefer not to do much
> longer).  Thanks - Neil

Fascinating---I saw mine fail on a non-Vax and figured that the code
was broken because it was tweaked for the Vaxen.

The problem lies in the lex code in zotnet/tws/lexstring.c, which
attempts to parse dates.  The code was generated by running lex and
putting its output into the .c file.  (Not the most robust way to
engineer a solution, but it works on most machines and besides, we got
more than what we paid for.)  The original lex source has disappeared,
I guess, because I asked Marshall Rose for it a long time ago but he
evidently got no answer from the code's author.

Anyway, the code makes a lot of assumptions about the constructs and
format that lex extrudes, which turns out to vary between systems.  If
your vendor altered the lex library to make it work on his architecture
(the lex routines are undocumented and so are fair game for changes),
this could break lexstring.c.

The way Norm Kincl fixed it for HP-UX was (from what I gather) by
comparing lex output on the BSD and HP-UX machines, then aligning the
HP-UX version to Do What It Means.  I can send you my version of
lexstring.c (the old code's still there; Norm used "#ifdef hpux") but
you'll still have to edit lexstring.c for your architecture.  The Norm
Kincl version will point out likely places where local tailoring might
have to be made.  Let me know if I should send it.

Hope this helps,
bob desinger
hpsemc!bd@hplabs.HP.COM
